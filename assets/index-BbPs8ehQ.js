(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&e(r)}).observe(document,{childList:!0,subtree:!0});function o(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function e(i){if(i.ep)return;i.ep=!0;const s=o(i);fetch(i.href,s)}})();function f(n){return Math.hypot(n.x,n.y)}function p(n){const t=f(n);return{x:n.x/t,y:n.y/t}}function w(n,t){return{x:n.x+t.x,y:n.y+t.y}}function A(n){let t={x:0,y:0};for(const o of n)t=w(t,o);return t}function M(n,t){return{x:n.x*t,y:n.y*t}}function E(n,t){return{x:n.x*Math.cos(t)-n.y*Math.sin(t),y:n.x*Math.sin(t)+n.y*Math.cos(t)}}function P(n,t){const o=t.x-n.x,e=t.y-n.y;return{x:o,y:e}}const R=1.602*10**-19,S=8.85418782*10**-12,c=50,G=10**-14.5,O="#a1a1a1",H=1,T=2,b="#fff",N=2,y=.5,l={positive:"#44e841",negative:"#c42d25",none:"#807d7d"},V="white",F=80,$="sans-serif",D=10,k=1/(4*Math.PI*S);function C(n){return n.magnitude*R}function W(n,t){const o=f(P(n.position,t.position));return k*(C(n)*C(t))/(o*G)**2}function Y(n,t,o){const e=n.position.x-t.position.x,i=n.position.y-t.position.y,s=Math.atan2(i,e);return{x:o*Math.cos(s),y:o*Math.sin(s)}}function I(n){return n===-1?"-":n===1?"+":n===0?"0":n>0?`+${n}`:`${n}`}function B(n){const t=document.getElementById("info-panel");t&&document.body.removeChild(t);const o=document.createElement("div");return o.id="info-panel",o.className="info-panel",o.textContent=n,o}let u;function U(){u=[]}function X(n,t,o){const e=t.x+o.x*c,i=t.y+o.y*c;n.beginPath(),n.moveTo(t.x,t.y),n.lineTo(e,i),n.strokeStyle="white",n.lineWidth=2,n.stroke();const s=Math.PI/6,r=10,a={x:t.x+o.x*c,y:t.y+o.y*c},d=E(p(o),Math.PI-s),m=E(p(o),Math.PI+s);n.beginPath(),n.moveTo(a.x,a.y),n.lineTo(a.x+d.x*r,a.y+d.y*r),n.moveTo(a.x,a.y),n.lineTo(a.x+m.x*r,a.y+m.y*r),n.stroke()}function K(n,t,o){n.strokeStyle=O,n.lineWidth=H;for(let e=0;e<n.canvas.width;e+=c)n.beginPath(),n.moveTo(e,0),n.lineTo(e,o),n.stroke();for(let e=0;e<n.canvas.height;e+=c)n.beginPath(),n.moveTo(0,e),n.lineTo(t,e),n.stroke()}function z(n){u.forEach(t=>{const o=nn(t.position.x,t.position.y);n.fillStyle=t.magnitude==0?l.none:t.magnitude>0?l.positive:l.negative,n.beginPath(),n.arc(o.x,o.y,y*c,0,2*Math.PI),n.fill(),n.strokeStyle=b,n.lineWidth=N,n.stroke();const e=I(t.magnitude);let i=F;for(n.font=`${i}px ${$}`;n.measureText(e).width>y*c;)i-=1,n.font=`${i}px sans-serif`;n.fillStyle=V,n.textAlign="center",n.textBaseline="middle",n.fillText(I(t.magnitude),o.x,o.y)})}function Z(n){for(let t=0;t<n.canvas.width;t+=c)for(let o=0;o<n.canvas.height;o+=c){const i={position:x(t,o),magnitude:1},s=[];for(const a of u)s.push(Y(i,a,W(i,a)));const r=J(j(A(s)));X(n,{x:t,y:o},r)}}function j(n){const t=f(n);return M(n,Math.log(1+t))}function J(n){const t=f(n);return t<=T?n:M(n,T/t)}function Q(n,t){if(!_(n,t.x,t.y))return;const o=g(n,t.x,t.y),e=h(o.x,o.y);return e!=null?B(`${e.position.x}, ${e.position.y}`):void 0}function q(n,t){const o=t.button,e=t.x,i=t.y,s=t.shiftKey;if(!_(n,e,i))return;const r=g(n,e,i);if(o==0){if(u.length==D){alert("You have reached the limit on charges!");return}h(r.x,r.y)==null&&u.push({position:g(n,e,i),magnitude:s?-1:1})}else if(o==2){const a=h(r.x,r.y);if(a!=null){const d=u.indexOf(a);u.splice(d,1)}}}function h(n,t){for(const o of u){const e=n-o.position.x,i=t-o.position.y;if(e**2+i**2<=y**2)return o}}function _(n,t,o){const e=v(n,t,o);return e.x>0&&e.x<n.canvas.width&&e.y>0&&e.y<n.canvas.height}function g(n,t,o){const e=v(n,t,o);return x(e.x,e.y)}function v(n,t,o){return{x:t-n.canvas.getBoundingClientRect().left,y:o-n.canvas.getBoundingClientRect().top}}function x(n,t){return{x:n/c,y:t/c}}function nn(n,t){return{x:n*c,y:t*c}}function tn(){const n=document.getElementById("fieldCanvas"),t=n.getContext("2d");n.addEventListener("contextmenu",o=>o.preventDefault()),t.fillStyle="black",t.fillRect(0,0,n.width,n.height),K(t,t.canvas.width,t.canvas.height),Z(t),z(t),document.onmousedown=o=>{q(t,o)},document.onmousemove=o=>{const e=Q(t,o);console.log(e),e!=null&&document.body.appendChild(e)}}function L(){tn(),requestAnimationFrame(L)}window.onload=()=>{U(),L()};
